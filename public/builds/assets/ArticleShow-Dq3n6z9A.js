import{j as e,q as N,r as k,v as w,a as $}from"./app-CjaGCVDx.js";import{A as S}from"./AuthenticatedLayout-CEKLbWvb.js";import{Comment as _}from"./Comment-kk-NjHcW.js";import E from"./StarRating-Ct4S63Ck.js";import{V as x}from"./index-ImKEloHt.js";import"./ApplicationLogo-DOnqxg94.js";import"./transition-BxbnLFt-.js";import"./index-DiEtMYjU.js";function L({content:a}){const r=C(a);return e.jsx("div",{className:"prose dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:r}})}function C(a){return a.map(r=>{const t=r.align?` style="text-align:${r.align};"`:"";switch(r.type){case"heading-one":return`<h1${t} class="text-3xl font-bold mb-4">${i(r.children)}</h1>`;case"heading-two":return`<h2${t} class="text-2xl font-semibold mb-3">${i(r.children)}</h2>`;case"paragraph":return`<p${t} class="text-base leading-relaxed mb-4">${i(r.children)}</p>`;case"block-quote":return`<blockquote${t} class="border-l-4 pl-4 italic text-gray-600 bg-gray-50 dark:bg-gray-800 dark:text-gray-300 rounded-md my-4 text-base">${i(r.children)}</blockquote>`;case"numbered-list":return`<ol${t} class="list-decimal list-inside pl-6 space-y-1 text-base mb-4">${h(r.children)}</ol>`;case"bulleted-list":return`<ul${t} class="list-disc list-inside pl-6 space-y-1 text-base mb-4">${h(r.children)}</ul>`;case"list-item":return`<li${t} class="mb-1">${i(r.children)}</li>`;default:return`<div${t} class="text-base mb-4">${i(r.children)}</div>`}}).join("")}function h(a){return a.map(r=>`<li${r.align?` style="text-align:${r.align};"`:""} class="mb-1">${i(r.children)}</li>`).join("")}function i(a){return a.map(r=>{let t=D(r.text||"");return r.code&&(t=`<code class="bg-gray-200 dark:bg-gray-700 text-red-600 dark:text-red-400 font-mono text-sm px-1 py-0.5 rounded">${t}</code>`),r.bold&&(t=`<strong class="font-semibold">${t}</strong>`),r.italic&&(t=`<em class="italic">${t}</em>`),r.underline&&(t=`<u class="underline">${t}</u>`),t}).join("")}function D(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function V({article:a,comments:r}){var u;const t=N().props.auth.user,[d,b]=k.useState(r),{data:c,setData:m,processing:g,errors:o,reset:y,setError:j,clearErrors:f}=w({value:"",description:"",article_id:a.id}),v=async l=>{l.preventDefault(),f();try{const s=await $.post(route("comments.store"),c);s.data.success&&(b(n=>({...n,data:[s.data.comment,...n.data]})),x.success(s.data.message),y())}catch(s){if(s.response&&s.response.status===422){const n=s.response.data;n.errors?Object.keys(n.errors).forEach(p=>{j(p,n.errors[p][0])}):x.error("Ya has comentado este artículo.")}else x.error("Ocurrió un error al enviar el comentario.")}};return e.jsxs(S,{header:e.jsx("h1",{className:"text-2xl font-light text-gray-900 dark:text-gray-100",children:a.title}),children:[e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-4xl px-4 sm:px-6 lg:px-8",children:e.jsxs("article",{className:"bg-gray-200 dark:bg-gray-800 bg-opacity-30 dark:bg-opacity-30 rounded-xl shadow-sm border border-gray-100 dark:border-gray-800",children:[e.jsx("div",{className:"aspect-video overflow-hidden rounded-t-xl",children:e.jsx("img",{src:a.image,alt:a.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"p-8 lg:p-12",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8 pb-6 border-b border-gray-100 dark:border-gray-800",children:[e.jsx("div",{className:"flex-shrink-0",children:(u=a.user.profile)!=null&&u.photo?e.jsx("img",{src:a.user.profile.photo,alt:a.user.full_name,className:"w-12 h-12 rounded-full object-cover ring-2 ring-gray-100 dark:ring-gray-700"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-rounded text-gray-400 text-xl",children:"account_circle"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.user.full_name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(a.created_at).toLocaleString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),e.jsx("h1",{className:"text-3xl lg:text-4xl font-light text-gray-900 dark:text-gray-100 mb-6 leading-tight",children:a.title}),e.jsx("div",{className:"text-xl text-gray-600 dark:text-gray-300 mb-8 font-light leading-relaxed",children:a.introduction}),e.jsx("div",{className:"prose prose-lg dark:prose-invert max-w-none prose-gray",children:e.jsx("div",{className:"text-gray-700 dark:text-gray-300 leading-relaxed whitespace-pre-wrap",children:e.jsx(L,{content:a.body})})})]})]})})}),e.jsx("div",{className:"pb-12",children:e.jsx("div",{className:"mx-auto max-w-4xl px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-gray-200 dark:bg-gray-800 bg-opacity-30 dark:bg-opacity-30 rounded-xl shadow-sm border border-gray-100 dark:border-gray-800",children:t?e.jsxs("div",{className:"p-8 lg:p-12",children:[e.jsx("h2",{className:"text-2xl font-light text-gray-900 dark:text-gray-100 mb-6",children:"Deja un comentario"}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Valoración (1 a 5)"}),e.jsx(E,{value:parseInt(c.value)||0,onChange:l=>m("value",l.toString()),error:o.value})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Comentario"}),e.jsx("textarea",{value:c.description,onChange:l=>m("description",l.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm dark:bg-gray-900 dark:text-white focus:border-rose-500 focus:ring-rose-500",rows:"4",required:!0}),o.description&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.description})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:g,className:"bg-rose-600 hover:bg-rose-700 disabled:opacity-50 text-white font-semibold px-4 py-2 rounded-md",children:g?"Enviando...":"Publicar comentario"})})]})]}):e.jsx("div",{className:"p-8 lg:p-12",children:e.jsx("p",{className:"text-base text-gray-500 dark:text-gray-400",children:"Debes estar autenticado para comentar."})})})})}),e.jsx("div",{className:"pb-12",children:e.jsx("div",{className:"mx-auto max-w-4xl px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-gray-200 dark:bg-gray-800 bg-opacity-30 dark:bg-opacity-30 rounded-xl shadow-sm border border-gray-100 dark:border-gray-800",children:e.jsxs("div",{className:"p-8 lg:p-12",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-light text-gray-900 dark:text-gray-100 mb-2",children:"Comentarios"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[d.data.length," ",d.data.length===1?"comentario":"comentarios"]})]}),d.data.length>0?e.jsx("div",{className:"space-y-8",children:d.data.map((l,s)=>e.jsx(_,{comment:l,index:s},l.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-rounded text-gray-400 text-2xl select-none",children:"chat_bubble_outline"})}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 select-none",children:"Aún no hay comentarios en este artículo"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1 select-none",children:"¡Sé el primero en comentar!"})]})]})})})})]})}export{V as default};
